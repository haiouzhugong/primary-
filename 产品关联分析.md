```python
import pandas as pd
# 采用mlxtend.frequent_patterns工具包，用其中的apriori算法分析数据中的频繁项集及关联规则
import mlxtend.frequent_patterns as mfp
```


```python
# 数据加载
df_product = pd.read_csv("D:\\数据源\\test2\\product.csv", encoding='gbk')
df_date = pd.read_csv("D:\\数据源\\test2\\date.csv", encoding='gbk')
df_customer = pd.read_csv('D:\\数据源\\test2\\customer.csv', encoding='gbk')
df_order = pd.read_csv('D:\\数据源\\test2\\order.csv', encoding='gbk')

df_order
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>订单日期</th>
      <th>年份</th>
      <th>订单数量</th>
      <th>产品ID</th>
      <th>客户ID</th>
      <th>交易类型</th>
      <th>销售区域ID</th>
      <th>销售大区</th>
      <th>国家</th>
      <th>区域</th>
      <th>产品类别</th>
      <th>产品型号名称</th>
      <th>产品名称</th>
      <th>产品成本</th>
      <th>利润</th>
      <th>单价</th>
      <th>销售金额</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016/1/1</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>14432BA</td>
      <td>1</td>
      <td>4</td>
      <td>西南区</td>
      <td>中国</td>
      <td>大中华区</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016/1/2</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>18741BA</td>
      <td>1</td>
      <td>4</td>
      <td>西南区</td>
      <td>中国</td>
      <td>大中华区</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016/1/2</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>27988BA</td>
      <td>1</td>
      <td>4</td>
      <td>西南区</td>
      <td>中国</td>
      <td>大中华区</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016/1/5</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>25710BA</td>
      <td>1</td>
      <td>4</td>
      <td>西南区</td>
      <td>中国</td>
      <td>大中华区</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016/1/6</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>14999BA</td>
      <td>1</td>
      <td>4</td>
      <td>西南区</td>
      <td>中国</td>
      <td>大中华区</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>60393</th>
      <td>2016/7/28</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>27198BA</td>
      <td>1</td>
      <td>6</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>60394</th>
      <td>2016/7/29</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>27087BA</td>
      <td>1</td>
      <td>6</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>60395</th>
      <td>2016/7/29</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>23385BA</td>
      <td>1</td>
      <td>6</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>60396</th>
      <td>2016/7/30</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>15444BA</td>
      <td>1</td>
      <td>6</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
    <tr>
      <th>60397</th>
      <td>2016/7/30</td>
      <td>2016</td>
      <td>1</td>
      <td>528</td>
      <td>15196BA</td>
      <td>1</td>
      <td>6</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>韩国</td>
      <td>配件</td>
      <td>Rawlings Heart of THE Hide-11.5</td>
      <td>棒球手套</td>
      <td>500.0</td>
      <td>1199.0</td>
      <td>1699.0</td>
      <td>1699.0</td>
    </tr>
  </tbody>
</table>
<p>60398 rows × 17 columns</p>
</div>




```python
# 根据客户，将产品名称和国家的数据进行one-hot编码
one_hot_product = pd.get_dummies(df_order["产品名称"])
one_hot_country = pd.get_dummies(df_order["国家"])
one_hoted = pd.merge(one_hot_country, one_hot_product, left_index=True, right_index=True)
one_hoted["客户ID"] = df_order["客户ID"]
one_hoted_data_raw = one_hoted.groupby(["客户ID"]).sum()
# print(one_hoted_data)
one_hoted_data_raw
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>中国</th>
      <th>中国台湾</th>
      <th>中国澳门</th>
      <th>中国香港</th>
      <th>新加坡</th>
      <th>韩国</th>
      <th>三角网架</th>
      <th>击打手套</th>
      <th>垒垫</th>
      <th>垒球</th>
      <th>...</th>
      <th>捕手护具</th>
      <th>棒球手套</th>
      <th>棒球服</th>
      <th>球棒与球棒袋</th>
      <th>球网</th>
      <th>皮带</th>
      <th>硬式棒球</th>
      <th>袜子</th>
      <th>装备包</th>
      <th>软式棒球</th>
    </tr>
    <tr>
      <th>客户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13021BA</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13022BA</th>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13023BA</th>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13024BA</th>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13025BA</th>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>31500BA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31501BA</th>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31502BA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31503BA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31504BA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>18484 rows × 23 columns</p>
</div>




```python
# 对one-hot数据进行再处理
def encode_units(val):
    if val > 0:
        return 1
    if val <= 0:
        return 0
data_final = one_hoted_data_raw.applymap(encode_units)
# print(data_final)
data_final
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>中国</th>
      <th>中国台湾</th>
      <th>中国澳门</th>
      <th>中国香港</th>
      <th>新加坡</th>
      <th>韩国</th>
      <th>三角网架</th>
      <th>击打手套</th>
      <th>垒垫</th>
      <th>垒球</th>
      <th>...</th>
      <th>捕手护具</th>
      <th>棒球手套</th>
      <th>棒球服</th>
      <th>球棒与球棒袋</th>
      <th>球网</th>
      <th>皮带</th>
      <th>硬式棒球</th>
      <th>袜子</th>
      <th>装备包</th>
      <th>软式棒球</th>
    </tr>
    <tr>
      <th>客户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13021BA</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13022BA</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13023BA</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13024BA</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13025BA</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>31500BA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31501BA</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31502BA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31503BA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31504BA</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>18484 rows × 23 columns</p>
</div>




```python
# 借助mlxtend库的apriori算法，计算频繁项集，并按照支持度从高到低排序显示结果
itemsets = mfp.apriori(data_final, use_colnames=True, min_support=0.02)
itemsets = itemsets.sort_values(by="support", ascending=False)

print("频繁项集（从大到小）：")
itemsets.reset_index().drop(columns=["index"])
```

    频繁项集（从大到小）：
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>support</th>
      <th>itemsets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.459316</td>
      <td>(棒球手套)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.423014</td>
      <td>(中国)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.346083</td>
      <td>(硬式棒球)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.322441</td>
      <td>(头盔)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.246051</td>
      <td>(球棒与球棒袋)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>128</th>
      <td>0.020288</td>
      <td>(韩国, 棒球手套, 头盔)</td>
    </tr>
    <tr>
      <th>129</th>
      <td>0.020288</td>
      <td>(新加坡, 球棒与球棒袋)</td>
    </tr>
    <tr>
      <th>130</th>
      <td>0.020234</td>
      <td>(棒球服, 皮带)</td>
    </tr>
    <tr>
      <th>131</th>
      <td>0.020071</td>
      <td>(中国台湾, 棒球服)</td>
    </tr>
    <tr>
      <th>132</th>
      <td>0.020071</td>
      <td>(软式棒球, 硬式棒球, 棒球服)</td>
    </tr>
  </tbody>
</table>
<p>133 rows × 2 columns</p>
</div>




```python
# 借助mlxtend库的apriori算法，计算频繁项之间的关联规则，按照提升度从大到小显示结果
rules = mfp.association_rules(itemsets, metric="lift", min_threshold=2)
rules = rules.sort_values(by="lift", ascending=False).reset_index().drop(columns=["index"])

print("关联规则（提升度从大到小）：")
rules
```

    关联规则（提升度从大到小）：
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>antecedents</th>
      <th>consequents</th>
      <th>antecedent support</th>
      <th>consequent support</th>
      <th>support</th>
      <th>confidence</th>
      <th>lift</th>
      <th>leverage</th>
      <th>conviction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(中国澳门, 软式棒球)</td>
      <td>(垒球)</td>
      <td>0.040089</td>
      <td>0.115938</td>
      <td>0.022560</td>
      <td>0.562753</td>
      <td>4.853909</td>
      <td>0.017912</td>
      <td>2.021882</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(垒球)</td>
      <td>(中国澳门, 软式棒球)</td>
      <td>0.115938</td>
      <td>0.040089</td>
      <td>0.022560</td>
      <td>0.194587</td>
      <td>4.853909</td>
      <td>0.017912</td>
      <td>1.191825</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(软式棒球)</td>
      <td>(三角网架, 硬式棒球)</td>
      <td>0.221218</td>
      <td>0.026672</td>
      <td>0.026672</td>
      <td>0.120567</td>
      <td>4.520421</td>
      <td>0.020771</td>
      <td>1.106768</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(三角网架, 硬式棒球)</td>
      <td>(软式棒球)</td>
      <td>0.026672</td>
      <td>0.221218</td>
      <td>0.026672</td>
      <td>1.000000</td>
      <td>4.520421</td>
      <td>0.020771</td>
      <td>inf</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(软式棒球, 头盔)</td>
      <td>(垒球)</td>
      <td>0.075092</td>
      <td>0.115938</td>
      <td>0.036626</td>
      <td>0.487752</td>
      <td>4.207005</td>
      <td>0.027920</td>
      <td>1.725848</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(垒球)</td>
      <td>(软式棒球, 头盔)</td>
      <td>0.115938</td>
      <td>0.075092</td>
      <td>0.036626</td>
      <td>0.315912</td>
      <td>4.207005</td>
      <td>0.027920</td>
      <td>1.352031</td>
    </tr>
    <tr>
      <th>6</th>
      <td>(球棒与球棒袋, 软式棒球)</td>
      <td>(垒球)</td>
      <td>0.067410</td>
      <td>0.115938</td>
      <td>0.029647</td>
      <td>0.439807</td>
      <td>3.793467</td>
      <td>0.021832</td>
      <td>1.578139</td>
    </tr>
    <tr>
      <th>7</th>
      <td>(垒球)</td>
      <td>(球棒与球棒袋, 软式棒球)</td>
      <td>0.115938</td>
      <td>0.067410</td>
      <td>0.029647</td>
      <td>0.255716</td>
      <td>3.793467</td>
      <td>0.021832</td>
      <td>1.253004</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(垒球, 棒球手套)</td>
      <td>(软式棒球)</td>
      <td>0.028619</td>
      <td>0.221218</td>
      <td>0.021749</td>
      <td>0.759924</td>
      <td>3.435178</td>
      <td>0.015417</td>
      <td>3.243902</td>
    </tr>
    <tr>
      <th>9</th>
      <td>(软式棒球)</td>
      <td>(垒球, 棒球手套)</td>
      <td>0.221218</td>
      <td>0.028619</td>
      <td>0.021749</td>
      <td>0.098313</td>
      <td>3.435178</td>
      <td>0.015417</td>
      <td>1.077292</td>
    </tr>
    <tr>
      <th>10</th>
      <td>(软式棒球)</td>
      <td>(垒球, 中国澳门)</td>
      <td>0.221218</td>
      <td>0.029755</td>
      <td>0.022560</td>
      <td>0.101981</td>
      <td>3.427301</td>
      <td>0.015978</td>
      <td>1.080428</td>
    </tr>
    <tr>
      <th>11</th>
      <td>(垒球, 中国澳门)</td>
      <td>(软式棒球)</td>
      <td>0.029755</td>
      <td>0.221218</td>
      <td>0.022560</td>
      <td>0.758182</td>
      <td>3.427301</td>
      <td>0.015978</td>
      <td>3.220526</td>
    </tr>
    <tr>
      <th>12</th>
      <td>(软式棒球)</td>
      <td>(垒球, 球棒与球棒袋)</td>
      <td>0.221218</td>
      <td>0.042199</td>
      <td>0.029647</td>
      <td>0.134018</td>
      <td>3.175885</td>
      <td>0.020312</td>
      <td>1.106029</td>
    </tr>
    <tr>
      <th>13</th>
      <td>(垒球, 球棒与球棒袋)</td>
      <td>(软式棒球)</td>
      <td>0.042199</td>
      <td>0.221218</td>
      <td>0.029647</td>
      <td>0.702564</td>
      <td>3.175885</td>
      <td>0.020312</td>
      <td>2.618318</td>
    </tr>
    <tr>
      <th>14</th>
      <td>(垒球)</td>
      <td>(棒球手套, 软式棒球)</td>
      <td>0.115938</td>
      <td>0.059890</td>
      <td>0.021749</td>
      <td>0.187587</td>
      <td>3.132220</td>
      <td>0.014805</td>
      <td>1.157184</td>
    </tr>
    <tr>
      <th>15</th>
      <td>(棒球手套, 软式棒球)</td>
      <td>(垒球)</td>
      <td>0.059890</td>
      <td>0.115938</td>
      <td>0.021749</td>
      <td>0.363144</td>
      <td>3.132220</td>
      <td>0.014805</td>
      <td>1.388165</td>
    </tr>
    <tr>
      <th>16</th>
      <td>(软式棒球)</td>
      <td>(垒球, 头盔)</td>
      <td>0.221218</td>
      <td>0.057239</td>
      <td>0.036626</td>
      <td>0.165566</td>
      <td>2.892556</td>
      <td>0.023964</td>
      <td>1.129822</td>
    </tr>
    <tr>
      <th>17</th>
      <td>(垒球, 头盔)</td>
      <td>(软式棒球)</td>
      <td>0.057239</td>
      <td>0.221218</td>
      <td>0.036626</td>
      <td>0.639887</td>
      <td>2.892556</td>
      <td>0.023964</td>
      <td>2.162601</td>
    </tr>
    <tr>
      <th>18</th>
      <td>(垒球)</td>
      <td>(软式棒球)</td>
      <td>0.115938</td>
      <td>0.221218</td>
      <td>0.067410</td>
      <td>0.581428</td>
      <td>2.628299</td>
      <td>0.041762</td>
      <td>1.860568</td>
    </tr>
    <tr>
      <th>19</th>
      <td>(软式棒球)</td>
      <td>(垒球)</td>
      <td>0.221218</td>
      <td>0.115938</td>
      <td>0.067410</td>
      <td>0.304720</td>
      <td>2.628299</td>
      <td>0.041762</td>
      <td>1.271519</td>
    </tr>
    <tr>
      <th>20</th>
      <td>(中国, 软式棒球)</td>
      <td>(三角网架)</td>
      <td>0.094568</td>
      <td>0.114153</td>
      <td>0.023858</td>
      <td>0.252288</td>
      <td>2.210094</td>
      <td>0.013063</td>
      <td>1.184744</td>
    </tr>
    <tr>
      <th>21</th>
      <td>(三角网架)</td>
      <td>(中国, 软式棒球)</td>
      <td>0.114153</td>
      <td>0.094568</td>
      <td>0.023858</td>
      <td>0.209005</td>
      <td>2.210094</td>
      <td>0.013063</td>
      <td>1.144674</td>
    </tr>
    <tr>
      <th>22</th>
      <td>(韩国)</td>
      <td>(三角网架)</td>
      <td>0.084992</td>
      <td>0.114153</td>
      <td>0.021045</td>
      <td>0.247613</td>
      <td>2.169137</td>
      <td>0.011343</td>
      <td>1.177382</td>
    </tr>
    <tr>
      <th>23</th>
      <td>(三角网架)</td>
      <td>(韩国)</td>
      <td>0.114153</td>
      <td>0.084992</td>
      <td>0.021045</td>
      <td>0.184360</td>
      <td>2.169137</td>
      <td>0.011343</td>
      <td>1.121828</td>
    </tr>
    <tr>
      <th>24</th>
      <td>(棒球服)</td>
      <td>(皮带)</td>
      <td>0.172690</td>
      <td>0.055129</td>
      <td>0.020234</td>
      <td>0.117168</td>
      <td>2.125350</td>
      <td>0.010714</td>
      <td>1.070273</td>
    </tr>
    <tr>
      <th>25</th>
      <td>(皮带)</td>
      <td>(棒球服)</td>
      <td>0.055129</td>
      <td>0.172690</td>
      <td>0.020234</td>
      <td>0.367026</td>
      <td>2.125350</td>
      <td>0.010714</td>
      <td>1.307022</td>
    </tr>
    <tr>
      <th>26</th>
      <td>(三角网架)</td>
      <td>(软式棒球, 硬式棒球)</td>
      <td>0.114153</td>
      <td>0.111069</td>
      <td>0.026672</td>
      <td>0.233649</td>
      <td>2.103640</td>
      <td>0.013993</td>
      <td>1.159953</td>
    </tr>
    <tr>
      <th>27</th>
      <td>(软式棒球, 硬式棒球)</td>
      <td>(三角网架)</td>
      <td>0.111069</td>
      <td>0.114153</td>
      <td>0.026672</td>
      <td>0.240136</td>
      <td>2.103640</td>
      <td>0.013993</td>
      <td>1.165798</td>
    </tr>
    <tr>
      <th>28</th>
      <td>(软式棒球)</td>
      <td>(中国, 三角网架)</td>
      <td>0.221218</td>
      <td>0.053506</td>
      <td>0.023858</td>
      <td>0.107850</td>
      <td>2.015678</td>
      <td>0.012022</td>
      <td>1.060914</td>
    </tr>
    <tr>
      <th>29</th>
      <td>(中国, 三角网架)</td>
      <td>(软式棒球)</td>
      <td>0.053506</td>
      <td>0.221218</td>
      <td>0.023858</td>
      <td>0.445905</td>
      <td>2.015678</td>
      <td>0.012022</td>
      <td>1.405502</td>
    </tr>
  </tbody>
</table>
</div>




```python

```
